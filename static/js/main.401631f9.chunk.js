(this.webpackJsonptemplate_react=this.webpackJsonptemplate_react||[]).push([[0],{106:function(e,t,n){},107:function(e,t,n){},109:function(e,t,n){},117:function(e,t,n){"use strict";n.r(t);var r,a,c=n(0),o=n.n(c),i=n(32),u=n.n(i),s=(n(106),n(107),n(12)),p=n(5),l=n.n(p),f=n(14),b=n(15),h=n(16),d=n(31),j=n(30),v=n(162),O=n(161),g=n(163),x=n(160),y=n(164),k=n(63),m=n.n(k),I=n(3),w=n(38),D="lk_regions",G={COUNTRY:"country",PROVINCE:"province",DISTRICT:"district",DSD:"dsd",GND:"gnd",PD:"pd",ED:"ed",MOH:"moh",LG:"lg",UNKNOWN:"unknown-entity"},T=Object.values(G),C=(r={},Object(I.a)(r,G.Country,"Country"),Object(I.a)(r,G.PROVINCE,"Province"),Object(I.a)(r,G.DISTRICT,"District"),Object(I.a)(r,G.DSD,"Divisional Secretariat Division"),Object(I.a)(r,G.GND,"Grama Niladhari Division"),Object(I.a)(r,G.PD,"Polling Division"),Object(I.a)(r,G.ED,"Electoral District"),Object(I.a)(r,G.MOH,"Medical Officer of Health Area"),Object(I.a)(r,G.LG,"Local Authority Area"),r),S=(a={},Object(I.a)(a,G.COUNTRY,G.PROVINCE),Object(I.a)(a,G.PROVINCE,G.DISTRICT),Object(I.a)(a,G.DISTRICT,G.DSD),Object(I.a)(a,G.DSD,G.GND),Object(I.a)(a,G.GND,void 0),Object(I.a)(a,G.PD,void 0),Object(I.a)(a,G.ED,[G.PD]),a),R=function(){function e(){Object(b.a)(this,e)}return Object(h.a)(e,null,[{key:"getEntType",value:function(e){if("LK"===e.substring(0,2))switch(e.length){case 2:return G.COUNTRY;case 4:return G.PROVINCE;case 5:return G.DISTRICT;case 7:return G.DSD;case 10:return G.GND;default:return G.UNKNOWN}if("EC"===e.substring(0,2))switch(e.length){case 5:return G.ED;case 6:return G.PD;default:return G.UNKNOWN}return"LG"===e.substring(0,2)?G.LG:"MOH"===e.substring(0,3)?G.MOH:G.UNKNOWN}},{key:"getRegionName",value:function(e){return C[e]}},{key:"getEntsByType",value:function(){var e=Object(f.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="/".concat(D,"/data/ents/").concat(t,".tsv"),e.next=3,w.b.tsv(n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getEntIndexByType",value:function(){var t=Object(f.a)(l.a.mark((function t(n){var r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getEntsByType(n);case 2:return r=t.sent,t.abrupt("return",r.reduce((function(e,t){return e[t.id]=t,e}),{}));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},{key:"getAllEntIndex",value:function(){var t=Object(f.a)(l.a.mark((function t(){var n,r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=T,t.next=3,Promise.all(n.map(function(){var t=Object(f.a)(l.a.mark((function t(n){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getEntIndexByType(n);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 3:return r=t.sent,t.abrupt("return",n.reduce((function(e,t,n){return e[t]=r[n],e}),{}));case 5:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()},{key:"getEnt",value:function(){var t=Object(f.a)(l.a.mark((function t(n){var r,a,c;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.getEntType(n),t.next=3,e.getEntIndexByType(r);case 3:return a=t.sent,(c=a[n]).centroid&&(c.centroid=JSON.parse(c.centroid)),t.abrupt("return",c);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},{key:"getParentToChildMap",value:function(){var e=Object(f.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"data/ents/parent_to_child_map.json",e.next=3,w.b.json("data/ents/parent_to_child_map.json");case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"getChildType",value:function(e){return S[e]}},{key:"getChildIDs",value:function(){var t=Object(f.a)(l.a.mark((function t(n,r){var a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getEntsByType(r);case 2:return a=t.sent,t.abrupt("return",a.map((function(e){return e.id})).filter((function(e){return e.includes(n)||"LK"===n})));case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"getEntTypeLongName",value:function(e){return C[e]?C[e]:w.a.toTitleCase(e)}}]),e}();function E(e,t){var n=Object(s.a)(e,2),r=n[0],a=n[1],c=0;for(var o in t){var i=(o-1+t.length)%t.length,u=Object(s.a)(t[o],2),p=u[0],l=u[1],f=Object(s.a)(t[i],2),b=f[0],h=f[1];l>r!==h>r&&a<(b-p)*(r-l)/(h-l)+p&&(c+=1)}return c%2===1}function N(e,t){for(var n in t){var r=t[n];for(var a in r){if(E(e,r[a]))return!0}}return!1}var P=function(){function e(){Object(b.a)(this,e)}return Object(h.a)(e,null,[{key:"getGeoForRegion",value:function(){var e=Object(f.a)(l.a.mark((function e(t){var n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=R.getEntType(t),r="/".concat(D,"/data/geo/").concat(n,"/").concat(t,".json"),e.next=4,w.b.json(r);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getRegionToGeo",value:function(){var t=Object(f.a)(l.a.mark((function t(n){var r;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all(n.map(function(){var t=Object(f.a)(l.a.mark((function t(n){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getGeoForRegion(n);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 2:return r=t.sent,t.abrupt("return",n.reduce((function(e,t,n){return e[t]=r[n],e}),{}));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},{key:"getRegionTree",value:function(){var e=Object(f.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="/".concat(D,"/data/geo/region_tree.json"),e.next=3,w.b.json(t);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"isPointInRegion",value:function(){var t=Object(f.a)(l.a.mark((function t(n,r){var a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getGeoForRegion(r);case 2:return a=t.sent,t.abrupt("return",N(n,a));case 4:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()},{key:"getRegionsForPoint",value:function(){var t=Object(f.a)(l.a.mark((function t(n){var r,a,c,o,i,u,s,p;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getRegionTree();case 2:r=t.sent,a={},t.t0=l.a.keys(T);case 5:if((t.t1=t.t0()).done){t.next=24;break}c=t.t1.value,o=T[c],i=Object.keys(r),u=!1,t.t2=l.a.keys(i);case 11:if((t.t3=t.t2()).done){t.next=20;break}return s=t.t3.value,p=i[s],t.next=16,e.isPointInRegion(n,p);case 16:t.sent&&(a[o]=p,r=r[p],u=!0),t.next=11;break;case 20:if(u){t.next=22;break}return t.abrupt("break",24);case 22:t.next=5;break;case 24:return t.abrupt("return",a);case 25:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}]),e}();var M=function(){function e(){Object(b.a)(this,e)}return Object(h.a)(e,null,[{key:"getGroupDataForRegionType",value:function(){var e=Object(f.a)(l.a.mark((function e(t){var n,r,a,c,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R.getEntsByType(t);case 2:return n=e.sent,r=n.map((function(e){return{groupID:e.id,name:e.name}})),a=r.reduce((function(e,t){return e[t.groupID]=t,e}),{}),c=n.map((function(e){return e.id})).filter((function(e){return t!==G.PD||"P"!==e.substring(5)})),o=c.reduce((function(e,t){return e[t]=t,e}),{}),e.abrupt("return",{mapID:"by_"+t,name:"By "+R.getEntTypeLongName(t),groupIndex:a,regionToGroup:o});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getMapInfoIndex",value:function(){var t=Object(f.a)(l.a.mark((function t(){var n;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.all([G.PROVINCE,G.DISTRICT,G.DSD,G.ED,G.PD].map(function(){var t=Object(f.a)(l.a.mark((function t(n){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getGroupDataForRegionType(n);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 2:return n=t.sent,t.abrupt("return",n.reduce((function(e,t){return e[t.mapID]=t,e}),{}));case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}]),e}(),L=n(148),_=n(165),F=n(149),z=(n(109),n(1)),B=function(e){Object(d.a)(n,e);var t=Object(j.a)(n);function n(){return Object(b.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){var e=this.props,t=e.center,n=e.zoom;return Object(z.jsxs)(L.a,{center:t,zoom:n,children:[Object(z.jsx)(_.a,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),Object(z.jsx)(F.a,{zoom:n,position:"bottomright"}),this.props.children]})}}]),n}(c.Component),H=n(166),U=n(158),K=n(159),V=function(e){Object(d.a)(n,e);var t=Object(j.a)(n);function n(e){var r;return Object(b.a)(this,n),(r=t.call(this,e)).state={regionEnt:void 0},r}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=Object(f.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R.getEnt(this.props.regionID);case 2:t=e.sent,this.setState({regionEnt:t});case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state.regionEnt,t=this.props.regionID;if(!e)return Object(z.jsx)(K.a,{label:t});var n=R.getEntType(t);return Object(z.jsx)(K.a,{sx:{m:.2},label:Object(z.jsxs)(U.a,{container:!0,direction:"row",alignItems:"center",children:[Object(z.jsx)(U.a,{item:!0,children:Object(z.jsx)(x.a,{variant:"body2",sx:{fontSize:9,fontWeight:800},children:e.name})}),Object(z.jsx)(U.a,{item:!0,children:Object(z.jsx)(x.a,{variant:"body2",sx:{paddingLeft:.5,fontSize:9},children:n.toUpperCase()})})]})})}}]),n}(c.Component),W=n(89),J=n.n(W),A=function(e){Object(d.a)(n,e);var t=Object(j.a)(n);function n(){return Object(b.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){var e=this.props,t=e.groupIndex,n=e.regionToGroup,r=e.onClickGroup,a=e.activeGroupID,c=Object.entries(n).reduce((function(e,t){var n=Object(s.a)(t,2),r=n[0],a=n[1];return a&&(e[a]||(e[a]=[]),e[a].push(r)),e}),{});return Object(z.jsx)(H.a,{sx:{position:"absolute",top:60,right:10,width:400,height:"70vh",m:2,p:2,zIndex:1e3,overflow:"scroll"},children:Object.entries(t).map((function(e,t){var n=Object(s.a)(e,2),o=n[0],i=n[1],u=c[o];u||(u=[]);var p=a===o?"red":"white",l="group-".concat(o);return Object(z.jsxs)(H.a,{sx:{m:1,p:1},onClick:function(){r(o)},children:[Object(z.jsxs)(U.a,{container:!0,direction:"row",alignItems:"center",children:[Object(z.jsx)(U.a,{item:!0,children:Object(z.jsx)(J.a,{sx:{color:p},fontSize:"smallest"})}),Object(z.jsx)(U.a,{item:!0,children:Object(z.jsx)(x.a,{variant:"overline",sx:{paddingLeft:1},children:i.name})})]}),Object(z.jsx)(O.a,{children:u.map((function(e,t){var n="region-".concat(e);return Object(z.jsx)(V,{regionID:e},n)}))})]},l)}))})}}]),n}(c.Component),Y=n(155),q=n(167),Q=n(156),X=n(153),Z=n(168),$=n(169),ee=function(e){Object(d.a)(n,e);var t=Object(j.a)(n);function n(){return Object(b.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){var e=this.props,t=e.showGroupSelector,n=e.onGroupSelectorHide,r=e.mapInfoIndex,a=e.onClickMap;return Object(z.jsx)(Y.a,{anchor:"right",open:t,onClose:n,sx:{width:400},children:Object(z.jsx)(H.a,{sx:{width:400},children:Object(z.jsx)(O.a,{sx:{width:"100%",maxWidth:360,bgcolor:"background.paper"},children:Object(z.jsx)(q.a,{children:Object.entries(r).map((function(e,t){var n=Object(s.a)(e,2),r=n[0],c=n[1],o="map-info-".concat(t);return Object(z.jsx)(Q.a,{disablePadding:!0,onClick:function(e){a(r)},children:Object(z.jsxs)(X.a,{children:[Object(z.jsx)(Z.a,{children:Object(z.jsx)(m.a,{})}),Object(z.jsx)($.a,{primary:c.name})]})},o)}))})})})})}}]),n}(c.Component),te=n(154);function ne(e){var t=e.regionID,n=e.geoJSON,r=e.color,a=e.onClickRegion,c={fillColor:r,color:"gray",weight:1,fillOpacity:.8};return Object(z.jsx)(te.a,{data:n,style:c,onEachFeature:function(e,n){n.on({click:function(e){a(t,e.originalEvent.altKey)}})}})}var re=[6.9157,79.8636],ae=function(e){Object(d.a)(n,e);var t=Object(j.a)(n);function n(e){var r;return Object(b.a)(this,n),(r=t.call(this,e)).state={selectedMapID:"by_province",mapInfoIndex:void 0,activeGroupID:void 0,regionToGeo:void 0,groupIndex:void 0,showGroupSelector:!1},r}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=Object(f.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state.selectedMapID,e.next=3,this.updateMap(t);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"updateMap",value:function(){var e=Object(f.a)(l.a.mark((function e(t){var n,r,a,c,o,i,u;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M.getMapInfoIndex();case 2:return n=e.sent,r=n[t],a=r.groupIndex,c=r.regionToGroup,o=Object.keys(a)[0],i=Object.keys(c),e.next=8,P.getRegionToGeo(i);case 8:u=e.sent,this.setState({mapInfoIndex:n,groupIndex:a,regionToGroup:c,activeGroupID:o,regionToGeo:u,selectedMapID:t});case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"expandRegion",value:function(){var e=Object(f.a)(l.a.mark((function e(t){var n,r,a,c,o,i,u;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.state.regionToGroup,r=R.getEntType(t),a=R.getChildType(r),e.next=5,R.getChildIDs(t,a);case 5:return c=e.sent,o=n[t],delete(n=c.reduce((function(e,t){return e[t]=o,e}),n))[t],i=Object.keys(n),e.next=12,P.getRegionToGeo(i);case 12:u=e.sent,this.setState({regionToGroup:n,regionToGeo:u});case 14:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onClickRegion",value:function(){var e=Object(f.a)(l.a.mark((function e(t,n){var r,a,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=5;break}return e.next=3,this.expandRegion(t);case 3:e.next=8;break;case 5:r=this.state,a=r.regionToGroup,c=r.activeGroupID,a[t]=a[t]===c?void 0:c,this.setState({regionToGroup:a});case 8:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onClickGroup",value:function(e){this.setState({activeGroupID:e})}},{key:"onGroupSelectorShow",value:function(){this.setState({showGroupSelector:!0})}},{key:"onGroupSelectorHide",value:function(){this.setState({showGroupSelector:!1})}},{key:"onClickMap",value:function(){var e=Object(f.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.updateMap(t);case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"renderRegions",value:function(){var e=this.state,t=e.regionToGroup,n=e.activeGroupID,r=e.regionToGeo;return Object.entries(t).map(function(e,t){var a,c=Object(s.a)(e,2),o=c[0],i=c[1],u={type:"MultiPolygon",coordinates:r[o]};a=n===i?"red":i?"pink":"lightgray";var p="region-".concat(t,"-").concat(o);return Object(z.jsx)(ne,{regionID:o,geoJSON:u,color:a,onClickRegion:this.onClickRegion.bind(this)},p)}.bind(this))}},{key:"render",value:function(){var e=this.state,t=e.groupIndex,n=e.showGroupSelector,r=e.regionToGroup,a=e.activeGroupID,c=e.mapInfoIndex,o=e.selectedMapID;return t?Object(z.jsxs)("div",{children:[Object(z.jsx)(O.a,{sx:{flexGrow:1},children:Object(z.jsx)(v.a,{position:"static",children:Object(z.jsxs)(g.a,{variant:"dense",children:[Object(z.jsx)(x.a,{variant:"h6",color:"inherit",component:"div",children:o}),Object(z.jsx)(O.a,{sx:{flexGrow:1}}),Object(z.jsx)(O.a,{sx:{display:{xs:"none",md:"flex"}},children:Object(z.jsx)(y.a,{size:"large","aria-label":"show 4 new mails",color:"inherit",onClick:this.onGroupSelectorShow.bind(this),children:Object(z.jsx)(m.a,{})})})]})})}),Object(z.jsx)(B,{center:re,zoom:8,children:this.renderRegions()}),Object(z.jsx)(A,{groupIndex:t,regionToGroup:r,onClickGroup:this.onClickGroup.bind(this),activeGroupID:a}),Object(z.jsx)(ee,{showGroupSelector:n,onGroupSelectorHide:this.onGroupSelectorHide.bind(this),mapInfoIndex:c,onClickMap:this.onClickMap.bind(this)})]}):"..."}}]),n}(c.Component);var ce=function(){return Object(z.jsx)(ae,{})},oe=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,170)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,o=t.getTTFB;n(e),r(e),a(e),c(e),o(e)}))};u.a.render(Object(z.jsx)(o.a.StrictMode,{children:Object(z.jsx)(ce,{})}),document.getElementById("root")),oe()}},[[117,1,2]]]);
//# sourceMappingURL=main.401631f9.chunk.js.map